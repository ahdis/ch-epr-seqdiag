

app -> mp_fhirserver: GET /metadata
activate mp_fhirserver
app <- mp_fhirserver: Conformance statement incl. OAuth 2.0 endpoints
deactivate mp_fhirserver

app -> mp_authzserver: Redirect to Authz Server (SMART standalone launce sequence or EHR launch sequence)\nwith OpenID Connect
activate mp_authzserver
mp_authzserver -> idp_user_authentication_provider: Authenticate User
activate idp_user_authentication_provider
mp_authzserver <- idp_user_authentication_provider
deactivate idp_user_authentication_provider
mp_authzserver -[#black]> cc_x_assertion_provider: Authorize User (needs access to X-Assertion User?)
activate cc_x_assertion_provider
mp_authzserver <[#black]- cc_x_assertion_provider
deactivate cc_x_assertion_provider
mp_authzserver -> app: On Approval redirect to app with code
deactivate mp_authzserver
app -> mp_authzserver: Exchange code for access token
activate mp_authzserver
app <- mp_authzserver: access token for response [JWT:UAP-ID]
deactivate mp_authzserver
